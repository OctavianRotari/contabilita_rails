<h2>Anno: <%= params[:year_param]%></h2>
<%= previos_year_menu("passive") %>
<%= next_year_menu("passive") %>
<% @invoices.each do |month, invoices| %>
	<h2><%= month.strftime('%B') %></h2>
	<table>
		<thead>
			<tr>
				<th>Fornitore</th>
				<th>Totale</th>
				<th>Iva</th>
				<th>Pagato</th>
				<th>Da pagare</th>
				<th>Motivo</th>
				<th>Data di emmissione</th>
				<th>Targa</th>
				<th>Scadenza</th>
				<th>Elimina</th>
				<th>Paga</th>
			</tr>
		</thead>
		<tfoot>
			<tr class="totals">
				<td>Totale:</td>
				<td><%= @calculator.total_all(invoices) %></td>
				<td><%= @calculator.total_vat_all(invoices) %></td>
				<td><%= @calculator.total_paid_or_collected_all(invoices) %></td>
				<td><%= @calculator.total_remaining_all(invoices) %></td>
			</tr>
		</tfoot>
		<tbody>
			<% for invoice in invoices %>
				<tr>
					<td><%= link_to invoice.company_name, company_path(invoice.company_id) %></td>
					<td><%= invoice.total %></td>
					<td><%= invoice.total_vat %></td>
					<td><%= @calculator.paid_per(invoice) %></td>
					<td><%= @calculator.to_pay_per(invoice) %></td>
					<td><%= link_to invoice.reason, invoice_path(company_id: invoice.company.id, id: invoice.id) %></td>
					<td><%= invoice.date_of_issue.strftime("%d-%m-%Y")%></td>
					<td><%= link_to_at_the_expense_of(invoice) %></td>
					<td><%= invoice.deadline.strftime("%d-%m-%Y")%></td>
					<td><%= button_to "Elimina fattura", invoice_path(company_id: invoice.company_id, id: invoice.id), method: :delete, data: {confirm: "Si e sicuri?"} %></td>
					<td><%= link_to "Paga", new_invoice_payment_path(invoice_id: invoice.id) %></td>
				</tr>
			<%end%>
		</tbody>
	</table>
<%end%>
